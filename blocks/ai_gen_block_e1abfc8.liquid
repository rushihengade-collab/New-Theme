{% doc %}
  @prompt
    Provide a section having blocks of Slide images with text, also provide the setting to have slides images position left or right, and other side have Tag with the background color and title and description, you have given only 1 image upload option provide 4, to have inside single slide, same image will slide all the image if uploaded, don't make separate box for everyone, remove the navigation arrow and dots, remove the button and change the slide every 1 second, after the last slide dont come reverse by going as 3-2-1, directly switch to first , example 1-2-3-1-2-3, like a circular thing
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-slide-block-{{ ai_gen_id }} {
    display: block;
    width: 100%;
    background-color: {{ block.settings.background_color }};
    padding: {{ block.settings.padding_vertical }}px {{ block.settings.padding_horizontal }}px;
  }

  .ai-slide-container-{{ ai_gen_id }} {
    display: flex;
    flex-direction: {% if block.settings.image_position == 'left' %}row{% else %}row-reverse{% endif %};
    align-items: center;
    gap: {{ block.settings.content_gap }}px;
    max-width: {{ block.settings.max_width }}px;
    margin: 0 auto;
  }

  .ai-slide-images-wrapper-{{ ai_gen_id }} {
    flex: 0 0 {{ block.settings.image_width }}%;
    position: relative;
    overflow: hidden;
  }

  .ai-slide-carousel-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    aspect-ratio: 1 / 1;
    border-radius: {{ block.settings.image_border_radius }}px;
    overflow: hidden;
  }

  .ai-slide-track-{{ ai_gen_id }} {
    display: flex;
    transition: transform 0.5s ease-in-out;
    height: 100%;
  }

  .ai-slide-track-{{ ai_gen_id }}.no-transition {
    transition: none;
  }

  .ai-slide-image-item-{{ ai_gen_id }} {
    min-width: 100%;
    height: 100%;
    position: relative;
  }

  .ai-slide-image-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .ai-slide-image-placeholder-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    background-color: #f4f4f4;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
  }

  .ai-slide-image-placeholder-{{ ai_gen_id }} svg {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .ai-slide-empty-state-{{ ai_gen_id }} {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    padding: 12px 20px;
    font-size: 14px;
    color: #666;
    text-align: center;
    pointer-events: none;
  }

  .ai-slide-content-{{ ai_gen_id }} {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: {{ block.settings.text_spacing }}px;
  }

  .ai-slide-tag-{{ ai_gen_id }} {
    display: inline-block;
    padding: {{ block.settings.tag_padding_vertical }}px {{ block.settings.tag_padding_horizontal }}px;
    background-color: {{ block.settings.tag_background_color }};
    color: {{ block.settings.tag_text_color }};
    font-size: {{ block.settings.tag_font_size }}px;
    font-weight: 600;
    border-radius: {{ block.settings.tag_border_radius }}px;
    text-transform: {{ block.settings.tag_text_transform }};
    letter-spacing: 0.5px;
    width: fit-content;
  }

  .ai-slide-title-{{ ai_gen_id }} {
    font-size: {{ block.settings.title_font_size }}px;
    color: {{ block.settings.title_color }};
    margin: 0;
    line-height: 1.2;
    font-family: {{ block.settings.title_font.family }}, {{ block.settings.title_font.fallback_families }};
    font-weight: {{ block.settings.title_font.weight }};
    text-transform: {{ block.settings.title_text_transform }};
  }

  .ai-slide-description-{{ ai_gen_id }} {
    font-size: {{ block.settings.description_font_size }}px;
    color: {{ block.settings.description_color }};
    line-height: 1.6;
    margin: 0;
  }

  @media screen and (max-width: 749px) {
    .ai-slide-container-{{ ai_gen_id }} {
      flex-direction: column;
      gap: {{ block.settings.mobile_content_gap }}px;
    }

    .ai-slide-images-wrapper-{{ ai_gen_id }} {
      flex: 0 0 100%;
      width: 100%;
    }

    .ai-slide-title-{{ ai_gen_id }} {
      font-size: {{ block.settings.title_font_size | times: 0.8 }}px;
    }

    .ai-slide-description-{{ ai_gen_id }} {
      font-size: {{ block.settings.description_font_size | times: 0.9 }}px;
    }
  }
{% endstyle %}

<image-slider-{{ ai_gen_id }} class="ai-slide-block-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-slide-container-{{ ai_gen_id }}">
    <div class="ai-slide-images-wrapper-{{ ai_gen_id }}">
      <div class="ai-slide-carousel-{{ ai_gen_id }}">
        <div class="ai-slide-track-{{ ai_gen_id }}" data-track>
          {% liquid
            assign has_images = false
            assign images_array = ''
            for i in (1..4)
              assign image_key = 'image_' | append: i
              assign current_image = block.settings[image_key]
              if current_image != blank
                assign has_images = true
              endif
            endfor
          %}

          {% if has_images %}
            {% for i in (1..4) %}
              {% liquid
                assign image_key = 'image_' | append: i
                assign current_image = block.settings[image_key]
              %}
              {% if current_image %}
                <div class="ai-slide-image-item-{{ ai_gen_id }}">
                  <img
                    src="{{ current_image | image_url: width: 1200 }}"
                    alt="{{ current_image.alt | escape }}"
                    loading="lazy"
                    width="{{ current_image.width }}"
                    height="{{ current_image.height }}"
                    class="ai-slide-image-{{ ai_gen_id }}"
                  >
                </div>
              {% endif %}
            {% endfor %}
            {% for i in (1..4) %}
              {% liquid
                assign image_key = 'image_' | append: i
                assign current_image = block.settings[image_key]
              %}
              {% if current_image %}
                <div class="ai-slide-image-item-{{ ai_gen_id }}">
                  <img
                    src="{{ current_image | image_url: width: 1200 }}"
                    alt="{{ current_image.alt | escape }}"
                    loading="lazy"
                    width="{{ current_image.width }}"
                    height="{{ current_image.height }}"
                    class="ai-slide-image-{{ ai_gen_id }}"
                  >
                </div>
              {% endif %}
            {% endfor %}
          {% else %}
            <div class="ai-slide-image-item-{{ ai_gen_id }}">
              <div class="ai-slide-image-placeholder-{{ ai_gen_id }}">
                {{ 'image' | placeholder_svg_tag }}
                <div class="ai-slide-empty-state-{{ ai_gen_id }}">
                  Add images to create a slideshow
                </div>
              </div>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="ai-slide-content-{{ ai_gen_id }}">
      {% if block.settings.tag != blank %}
        <div class="ai-slide-tag-{{ ai_gen_id }}">
          {{ block.settings.tag }}
        </div>
      {% endif %}

      {% if block.settings.title != blank %}
        <h2 class="ai-slide-title-{{ ai_gen_id }}">
          {{ block.settings.title }}
        </h2>
      {% endif %}

      {% if block.settings.description != blank %}
        <div class="ai-slide-description-{{ ai_gen_id }}">
          {{ block.settings.description }}
        </div>
      {% endif %}
    </div>
  </div>
</image-slider-{{ ai_gen_id }}>

<script>
  (function() {
    class ImageSlider{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.currentIndex = 0;
        this.autoplayInterval = null;
      }

      connectedCallback() {
        this.track = this.querySelector('[data-track]');
        this.slides = this.track.querySelectorAll('.ai-slide-image-item-{{ ai_gen_id }}');
        this.totalSlides = this.slides.length;
        this.actualSlides = this.totalSlides / 2;

        if (this.totalSlides <= 1) return;

        {% if block.settings.autoplay %}
          this.startAutoplay();
        {% endif %}
      }

      goToSlide(index, instant = false) {
        if (instant) {
          this.track.classList.add('no-transition');
        }
        
        this.currentIndex = index;
        const offset = -100 * this.currentIndex;
        this.track.style.transform = `translateX(${offset}%)`;

        if (instant) {
          setTimeout(() => {
            this.track.classList.remove('no-transition');
          }, 50);
        }
      }

      goToNext() {
        this.currentIndex++;
        this.goToSlide(this.currentIndex);

        if (this.currentIndex >= this.actualSlides) {
          setTimeout(() => {
            this.goToSlide(0, true);
          }, 500);
        }
      }

      startAutoplay() {
        this.stopAutoplay();
        this.autoplayInterval = setInterval(() => {
          this.goToNext();
        }, 1000);
      }

      stopAutoplay() {
        if (this.autoplayInterval) {
          clearInterval(this.autoplayInterval);
          this.autoplayInterval = null;
        }
      }

      disconnectedCallback() {
        this.stopAutoplay();
      }
    }

    customElements.define('image-slider-{{ ai_gen_id }}', ImageSlider{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Image slide with text",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "image_position",
      "label": "Images position",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "left"
    },
    {
      "type": "range",
      "id": "max_width",
      "label": "Maximum width",
      "min": 600,
      "max": 1600,
      "step": 100,
      "unit": "px",
      "default": 1200
    },
    {
      "type": "range",
      "id": "image_width",
      "label": "Images area width",
      "min": 30,
      "max": 70,
      "step": 5,
      "unit": "%",
      "default": 50
    },
    {
      "type": "range",
      "id": "content_gap",
      "label": "Gap between images and text",
      "min": 20,
      "max": 100,
      "step": 10,
      "unit": "px",
      "default": 60
    },
    {
      "type": "range",
      "id": "mobile_content_gap",
      "label": "Mobile gap",
      "min": 10,
      "max": 60,
      "step": 5,
      "unit": "px",
      "default": 30
    },
    {
      "type": "range",
      "id": "padding_vertical",
      "label": "Vertical padding",
      "min": 0,
      "max": 100,
      "step": 10,
      "unit": "px",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_horizontal",
      "label": "Horizontal padding",
      "min": 0,
      "max": 100,
      "step": 10,
      "unit": "px",
      "default": 20
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Images"
    },
    {
      "type": "image_picker",
      "id": "image_1",
      "label": "Image 1"
    },
    {
      "type": "image_picker",
      "id": "image_2",
      "label": "Image 2"
    },
    {
      "type": "image_picker",
      "id": "image_3",
      "label": "Image 3"
    },
    {
      "type": "image_picker",
      "id": "image_4",
      "label": "Image 4"
    },
    {
      "type": "range",
      "id": "image_border_radius",
      "label": "Border radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "Slideshow settings"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Auto-rotate slides",
      "default": true
    },
    {
      "type": "header",
      "content": "Tag"
    },
    {
      "type": "text",
      "id": "tag",
      "label": "Tag text",
      "default": "New"
    },
    {
      "type": "color",
      "id": "tag_background_color",
      "label": "Background",
      "default": "#5c5c5c"
    },
    {
      "type": "color",
      "id": "tag_text_color",
      "label": "Text",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "tag_font_size",
      "label": "Font size",
      "min": 10,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 12
    },
    {
      "type": "range",
      "id": "tag_padding_vertical",
      "label": "Vertical padding",
      "min": 2,
      "max": 20,
      "step": 2,
      "unit": "px",
      "default": 6
    },
    {
      "type": "range",
      "id": "tag_padding_horizontal",
      "label": "Horizontal padding",
      "min": 5,
      "max": 30,
      "step": 5,
      "unit": "px",
      "default": 15
    },
    {
      "type": "range",
      "id": "tag_border_radius",
      "label": "Border radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 4
    },
    {
      "type": "select",
      "id": "tag_text_transform",
      "label": "Text transform",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "uppercase",
          "label": "Uppercase"
        },
        {
          "value": "lowercase",
          "label": "Lowercase"
        },
        {
          "value": "capitalize",
          "label": "Capitalize"
        }
      ],
      "default": "uppercase"
    },
    {
      "type": "header",
      "content": "Title"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Discover our latest collection"
    },
    {
      "type": "font_picker",
      "id": "title_font",
      "label": "Font",
      "default": "helvetica_n4"
    },
    {
      "type": "range",
      "id": "title_font_size",
      "label": "Font size",
      "min": 20,
      "max": 80,
      "step": 2,
      "unit": "px",
      "default": 40
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Color",
      "default": "#000000"
    },
    {
      "type": "select",
      "id": "title_text_transform",
      "label": "Text transform",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "uppercase",
          "label": "Uppercase"
        },
        {
          "value": "lowercase",
          "label": "Lowercase"
        },
        {
          "value": "capitalize",
          "label": "Capitalize"
        }
      ],
      "default": "none"
    },
    {
      "type": "header",
      "content": "Description"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Explore our carefully curated selection of premium products designed to elevate your everyday experience."
    },
    {
      "type": "range",
      "id": "description_font_size",
      "label": "Font size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 16
    },
    {
      "type": "color",
      "id": "description_color",
      "label": "Color",
      "default": "#5c5c5c"
    },
    {
      "type": "range",
      "id": "text_spacing",
      "label": "Spacing between elements",
      "min": 10,
      "max": 40,
      "step": 5,
      "unit": "px",
      "default": 20
    }
  ],
  "presets": [
    {
      "name": "Image slide with text"
    }
  ]
}
{% endschema %}
